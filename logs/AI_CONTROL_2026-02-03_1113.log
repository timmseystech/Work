==== AI SESSION HEADER ====
Task:        CONTROL
Objective:   Create and validate session control wrapper (transcript + enforced header logging).
Constraints: PowerShell-only; no external downloads/services/scheduled tasks; no GUI automation; session-only ExecutionPolicy; logs authoritative.

WindowsProductName: Windows 10 Home
OsName:            Microsoft Windows 11 Home
WinVersion:

Stop = 'Stop'
. C:\AI_Tools\AI.ps1

CONTROL = 'CONTROL'

# --- Create AI.Run.ps1 (session wrapper)
C:\AI_Scripts\AI.Run.ps1 = 'C:\AI_Scripts\AI.Run.ps1'
@'
param(
    [Parameter(Mandatory)][string]CONTROL,
    [Parameter(Mandatory)][string]Create and validate session control wrapper (transcript + enforced header logging).,
    [Parameter(Mandatory)][string]PowerShell-only; no external downloads/services/scheduled tasks; no GUI automation; session-only ExecutionPolicy; logs authoritative.
)

Set-StrictMode -Version Latest
Stop = 'Stop'

# Elevation gate
True = ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()
).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
if (-not True) { throw "Not elevated. Relaunch PowerShell as Administrator." }

# Session-only execution policy gate (no persistence)
Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass -Force

. C:\AI_Tools\AI.ps1

# Establish log + transcript paths
C:\AI_Logs\AI_CONTROL_2026-02-03_1113.log = New-AILogPath -Task CONTROL
C:\AI_Logs\AI_CONTROL_2026-02-03_1113_transcript.txt = C:\AI_Logs\AI_CONTROL_2026-02-03_1113.log -replace '\.log$','_transcript.txt'

# Start transcript
Start-Transcript -Path C:\AI_Logs\AI_CONTROL_2026-02-03_1113_transcript.txt -Force | Out-Null

# Write header into log (separate from transcript)
@{WindowsProductName=Windows 10 Home; WindowsVersion=2009; OsName=Microsoft Windows 11 Home; OsVersion=10.0.26200; OsBuildNumber=26200}  = Get-ComputerInfo -Property WindowsProductName, WindowsVersion, OsName, OsVersion, OsBuildNumber |
       Select-Object WindowsProductName,WindowsVersion,OsName,OsVersion,OsBuildNumber
5.1.26100.7705 = System.Collections.Hashtable.PSVersion.ToString()
02/03/2026 11:13:24  = Get-Date

@"
==== AI SESSION HEADER ====
Task:        CONTROL
Objective:   Create and validate session control wrapper (transcript + enforced header logging).
Constraints: PowerShell-only; no external downloads/services/scheduled tasks; no GUI automation; session-only ExecutionPolicy; logs authoritative.

WindowsProductName: Windows 10 Home
OsName:            Microsoft Windows 11 Home
WinVersion:        2009
OsVersion:         10.0.26200
OS Build:          26200
PowerShell:        5.1.26100.7705
Start:             02/03/2026 11:13:24
Log:               C:\AI_Logs\AI_CONTROL_2026-02-03_1113.log
Transcript:        C:\AI_Logs\AI_CONTROL_2026-02-03_1113_transcript.txt
==========================
